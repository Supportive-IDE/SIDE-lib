"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConditionalSequence=exports.Conditional=void 0;var _expression=require("./expression.js");function _createForOfIteratorHelper(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,l=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return s=e.done,e},e:function(e){l=!0,a=e},f:function(){try{s||null==i.return||i.return()}finally{if(l)throw a}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _classPrivateFieldInitSpec(e,t,i){_checkPrivateRedeclaration(e,t),t.set(e,i)}function _checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet(e,t){return _classApplyDescriptorGet(e,_classExtractFieldDescriptor(e,t,"get"))}function _classApplyDescriptorGet(e,t){return t.get?t.get.call(e):t.value}function _classPrivateFieldSet(e,t,i){return _classApplyDescriptorSet(e,_classExtractFieldDescriptor(e,t,"set"),i),i}function _classExtractFieldDescriptor(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance");return t.get(e)}function _classApplyDescriptorSet(e,t,i){if(t.set)t.set.call(e,i);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=i}}var _ifLineIndex=new WeakMap,_elifLineIndices=new WeakMap,_elseLineIndex=new WeakMap,Conditional=function(){function e(t){_classCallCheck(this,e),_classPrivateFieldInitSpec(this,_ifLineIndex,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_elifLineIndices,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_elseLineIndex,{writable:!0,value:void 0}),_classPrivateFieldSet(this,_ifLineIndex,t),_classPrivateFieldSet(this,_elifLineIndices,[]),_classPrivateFieldSet(this,_elseLineIndex,-1)}return _createClass(e,[{key:"addBranch",value:function(e,t){e===_expression.ExpressionEntity.ElifDefinition?_classPrivateFieldGet(this,_elifLineIndices).push(t):e===_expression.ExpressionEntity.ElseDefinition&&_classPrivateFieldSet(this,_elseLineIndex,t)}},{key:"addElif",value:function(e){_classPrivateFieldGet(this,_elifLineIndices).push(e)}},{key:"setElse",value:function(e){_classPrivateFieldSet(this,_elseLineIndex,e)}},{key:"hasElifs",value:function(){return _classPrivateFieldGet(this,_elifLineIndices).length>0}},{key:"hasElse",value:function(){return _classPrivateFieldGet(this,_elseLineIndex)>=0}},{key:"getIfIndex",value:function(){return _classPrivateFieldGet(this,_ifLineIndex)}},{key:"getElifs",value:function(){return _classPrivateFieldGet(this,_elifLineIndices)}},{key:"getElseIndex",value:function(){return _classPrivateFieldGet(this,_elseLineIndex)}},{key:"isExhaustive",value:function(){return this.hasElse()}},{key:"getNumberOfBranches",value:function(){return 1+_classPrivateFieldGet(this,_elifLineIndices).length+(_classPrivateFieldGet(this,_elseLineIndex)>=0?1:0)}}]),e}();exports.Conditional=Conditional;var _sequence=new WeakMap,ConditionalSequence=function(){function e(){_classCallCheck(this,e),_classPrivateFieldInitSpec(this,_sequence,{writable:!0,value:[]})}return _createClass(e,[{key:"addBranch",value:function(e,t){_classPrivateFieldGet(this,_sequence).push({lineNum:e,docIndex:t})}},{key:"containsBranch",value:function(e){var t,i=_createForOfIteratorHelper(_classPrivateFieldGet(this,_sequence));try{for(i.s();!(t=i.n()).done;){var n=t.value;if(n.lineNum===e)return!0;if(n.lineNum>e)return!1}}catch(e){i.e(e)}finally{i.f()}return!1}},{key:"isEmpty",value:function(){return 0===_classPrivateFieldGet(this,_sequence).length}},{key:"toJSON",value:function(){return _classPrivateFieldGet(this,_sequence)}}]),e}();exports.ConditionalSequence=ConditionalSequence;
